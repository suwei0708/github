function getUrlParameterByName(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))}function initMusic(){var e=$("audio")[0];$(".player-btn").on("click",function(){var a=$(this);a.hasClass("player-btn-stop")?e.play():e.pause(),a.toggleClass("player-btn-stop")})}function initPageEvents(){$("body").on("touchmove",function(e){e.preventDefault()}),$(".page0 .btn").on("click",function(){app.swiper.slideTo(1,0,!1),hanldeAnimate(1),$(".finger-box").show(),$(".anim1-in").show(),$("audio").attr("src",app.baseUrl+"music1.mp3")[0].play(),$(".player-btn").removeClass("player-btn-stop"),app.swiper.allowSlideNext=!1,setTimeout(function(){app.swiper.allowSlideNext=!0},3e3)}),$(".page5 .btn").on("click",function(){app.swiper.slideTo(6,0,!1),hanldeAnimate(6)}),$(".option").on("click","li",function(){$(".option-result").show().find("img").eq($(this).index()).show()}),$(".share").on("click",function(){$(this).hide()});var e;$("#form input").on("focus",function(){e=$(this).attr("placeholder"),$(this).attr("placeholder","")}).on("blur",function(){$(this).attr("placeholder",e)}),$("#form").on("click",".btn",function(){return $.trim($("#form input[name=name]").val())?$.trim($("#form input[name=mobile]").val())?/^1\d{10}$/.test($.trim($("#form input[name=mobile]").val()))?($.ajax({url:"https://m.xinliling.com/trees?type=1",type:"POST",dataType:"json",data:$("#form").serialize()}).done(function(e){var a={title:"3月31日，我是第"+e.total_user+"位来听老狼把青春唱完的见 证者",desc:"春暖花开的时节，听一曲老狼，再忆念念不忘的青春时光"};weixin.bindData(a),weixin.bindShareInfo(),$(".page6").find(".result").show(),setTimeout(function(){app.swiper.slideTo(7,0,!1),hanldeAnimate(7)},2e3)}).fail(function(e){422==e.status?alert(e.responseText):alert("网络错误，请稍后重试")}),!1):(alert("电话号码格式不正确"),!1):(alert("手机号码不能为空！"),!1):(alert("姓名不能为空！"),!1)})}function checkIsPC(){var e={win:!1,mac:!1,xll:!1},a=navigator.platform;e.win=0==a.indexOf("Win"),e.mac=0==a.indexOf("Mac"),e.x11="X11"==a||0==a.indexOf("Linux");return!!($(window).width()>app.DEFAULT_WIDTH&&(e.win||e.mac||e.xll))}function hanldeAnimate(e){$(".swiper-slide").find("[data-anim]").each(function(){$(this).removeClass($(this).data("anim"))}),$(".swiper-slide").eq(e).find("[data-anim]").each(function(){$(this).addClass($(this).data("anim"))})}function fit(e){var a,i=$(window).width(),n=$(window).height();a=i/n>app.DEFAULT_WIDTH/app.DEFAULT_HEIGHT?n/app.DEFAULT_HEIGHT:i/app.DEFAULT_WIDTH,$(e).css({"-webkit-transform":"scale("+a+")",transform:"scale("+a+")","-webkit-transform-origin":"50% 50% 0","transform-origin":"50% 50% 0","margin-left":(app.DEFAULT_WIDTH-i)/-2+"px","margin-top":(app.DEFAULT_HEIGHT-n)/-2+"px"})}var app={};app.width,app.height,app.loop=!1,app.DEFAULT_WIDTH=750,app.DEFAULT_HEIGHT=1212,app.baseUrl="static/img/",app.init=function(){app.loop=getUrlParameterByName("loop")||!1;var e=[app.baseUrl+"p5/option.png",app.baseUrl+"p6/input.png",app.baseUrl+"p6/btn.png",app.baseUrl+"anim1.png",app.baseUrl+"anim2.png",app.baseUrl+"anim3.png",app.baseUrl+"anim4.png"];$.each($("#content img"),function(a){e.push($(this).attr("src"))}),console.log(e),$.imgpreload(e,{each:function(a){if("success"==($(this).data("loaded")?"success":"error")){var i=(a.length/e.length).toFixed(2);$("#percentage").html(Math.round(100*i)+"%")}},all:function(){setTimeout(function(){$(".loading").hide(0,function(){hanldeAnimate(0)})},500)}});app.swiper=new Swiper(".swiper-container",{direction:"horizontal",loop:app.loop,longSwipesRatio:.1,initialSlide:0,preventClicks:!0,preventClicksPropagation:!0,followFinger:!1,resistanceRatio:0,speed:3e3,allowSlidePrev:!1,noSwiping:!0,preventIntercationOnTransition:!0,on:{slideNextTransitionStart:function(){var e=this.activeIndex;e<=5&&($(".anim"+(e-1)+"-in").hide(),$(".anim"+(e-1)+"-out").show(),$(".page"+(e-1)).find(".mask").removeClass("fade-in-out"),$(".finger-box").hide(),app.swiper.allowSlideNext=!1)},slideChangeTransitionEnd:function(){var e=this.activeIndex;e<5?($(".finger-box").show(),$(".anim"+(e-1)).hide(),$(".anim"+e+"-in").show(),$("audio").attr("src",app.baseUrl+"music"+e+".mp3")[0].play(),$(".player-btn").removeClass("player-btn-stop"),setTimeout(function(){app.swiper.allowSlideNext=!0},3e3)):5==e&&($(".anim"+(e-1)).hide(),app.swiper.allowSlideNext=!0,$("audio").attr("src",app.baseUrl+"music"+e+".mp3")[0].play()),$(".player-btn").removeClass("player-btn-stop"),hanldeAnimate(e)}}}),initMusic()},$(function(){app.init();app.swiper.slides.length,app.swiper.activeIndex;var e=$("audio")[0],a=$(".player-btn");e&&e.play(),document.addEventListener("WeixinJSBridgeReady",function(){a.hasClass("player-btn-stop")?e.pause():e.play()},!1),initPageEvents()});