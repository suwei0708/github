function getUrlParameterByName(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e=new RegExp("[\\?&]"+a+"=([^&#]*)").exec(location.search);return null===e?"":decodeURIComponent(e[1].replace(/\+/g," "))}function initPageEvents(){document.body.addEventListener("touchmove",function(a){a.preventDefault()},{passive:!1}),$("body").on("click",function(){$(".share-box").is(":visible")&&$(".share-box").hide()}),$(".page0").on("click",".btn",function(){app.swiper.slideTo(1,0,!1),hanldeAnimate(1)}),$(".page7").on("click",".btn",function(){return!!isClick&&(app.manswer.src=app.msubmit,app.manswer.play(),$.trim($("#form input[name=name]").val())?$.trim($("#form input[name=mobile]").val())?/^1\d{10}$/.test($.trim($("#form input[name=mobile]").val()))?$.trim($("#form input[name=age]").val())?(isClick=0,$("#form input[name=name]").focus(),$.ajax({url:"https://m.xinliling.com/trees?type=3",type:"POST",dataType:"json",data:$("#form").serialize()}).done(function(a){var e={title:$.trim($("#form input[name=name]").val())+"长沙市文明办、长沙公安交警队认证您为第"+a.total_user+"名交通文明践行者，城市文明接力邀您一起加入！",desc:"122全国交通安全日答题测验，成绩满分将有机会亲临老司机挑战赛现场，用车技赢取华为mate20和千元油卡"};weixin.bindData(e),weixin.bindShareInfo();var n=$.trim($("#form input[name=name]").val());$(".page8").find(".name").html(n);var t=convertImageToCanvas(document.getElementById("ringoImage"),document.getElementById("ecode"),n);document.getElementById("canvasHolder").appendChild(t),document.getElementById("pngHolder").appendChild(convertCanvasToImage(t)),$("#form input[name=name]").blur(),alert("报名成功！"),app.swiper.slideTo(8,0,!1)}).fail(function(a){422==a.status?alert(a.responseText):alert("网络错误，请稍后重试")}).always(function(){isClick=1}),!1):(alert("车龄不能为空！"),!1):(alert("电话号码格式不正确"),!1):(alert("电话号码不能为空！"),!1):(alert("姓名不能为空！"),!1))}),$(".btn-share").on("click",function(){return $(".share-box").show(),!1}),$(".btn-replay").on("click",function(){window.location.reload()})}function checkIsPC(){var a={win:!1,mac:!1,xll:!1},e=navigator.platform;a.win=0==e.indexOf("Win"),a.mac=0==e.indexOf("Mac"),a.x11="X11"==e||0==e.indexOf("Linux");return!!($(window).width()>app.DEFAULT_WIDTH&&(a.win||a.mac||a.xll))}function hanldeAnimate(a){$(".swiper-slide").find("[data-anim]").each(function(){$(this).removeClass($(this).data("anim"))}),$(".swiper-slide").eq(a).find("[data-anim]").each(function(){$(this).addClass($(this).data("anim"))})}function isIOS(){var a=navigator.userAgent;navigator.appVersion;return!!!!a.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)}function area(a,e,n){if(!isClick)return!1;if(isClick=0,$(".page"+(n-1)).find(".talk-"+a).addClass("fade-in-out"),e>0?($(".page"+(n-1)).find(".card").addClass("fade-in-out2"),app.manswer.src=app.mright,app.manswer.play()):(app.manswer.src=app.mwrong,app.manswer.play()),setTimeout(function(){app.swiper.slideTo(n,0,!1),hanldeAnimate(n),isClick=1},2e3),resultNum+=e,7==n){var t="a";t=resultNum<=60?"a":resultNum<=80?"b":resultNum<=100?"c":"d",$(".page8").find(".result").attr("src",app.baseUrl+"p8/"+t+".png"),$("#ringoImage").attr("src",app.baseUrl+"p8/result-"+t+".png")}}function convertImageToCanvas(a,e,n){var t=document.createElement("canvas");t.width=a.width,t.height=a.height;var i=t.getContext("2d");return i.save(),i.drawImage(a,0,0),i.drawImage(e,499,933,160,160),i.translate(90,180),i.rotate(-2.5*Math.PI/180),i.fillStyle="#2c225e",i.font="bold 42px Microsoft Yahei",i.fillText(n,0,0),i.restore(),i.stroke(),t}function convertCanvasToImage(a){var e=new Image;return e.crossOrigin="anonymous",e.src=a.toDataURL("image/png"),e}var app={},resultNum=0,isClick=1;app.width,app.height,app.loop=!1,app.DEFAULT_WIDTH=750,app.DEFAULT_HEIGHT=1218,app.baseUrl="static/img/",app.music=$("audio")[0],app.manswer=$("audio")[1],app.mright="static/music/right.mp3",app.mwrong="static/music/wrong.m4a",app.msubmit="static/music/submit.mp3",app.init=function(){app.music&&app.music.play(),document.addEventListener("WeixinJSBridgeReady",function(){app.music.play()},!1),app.loop=getUrlParameterByName("loop")||!1;var a=[];$.each($("#content img"),function(e){a.push($(this).attr("src"))}),$.imgpreload(a,{each:function(e){if("success"==($(this).data("loaded")?"success":"error")){var n=(e.length/a.length).toFixed(2);$("#percentage").html(Math.round(100*n)+"%")}},all:function(){setTimeout(function(){$(".loading").hide(),hanldeAnimate(0)},500)}});var e=$(window).height()>app.DEFAULT_HEIGHT?$(window).height():app.DEFAULT_HEIGHT;app.swiper=new Swiper(".swiper-container",{direction:"vertical",loop:app.loop,allowTouchMove:!1,longSwipesRatio:.1,initialSlide:0,preventClicks:!0,preventClicksPropagation:!0,width:app.DEFAULT_WIDTH,height:e,noSwiping:!0})},$(function(){app.init(),initPageEvents()});var result=[];